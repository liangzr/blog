<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="729px" preserveAspectRatio="none" style="width:727px;height:729px;" version="1.1" viewBox="0 0 727 729" width="727px" zoomAndPan="magnify"><defs><filter height="300%" id="f1masgnn5sk3fv" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster updateComponent--><rect fill="#FEFECE" filter="url(#f1masgnn5sk3fv)" height="581" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="285" x="30" y="113"/><rect fill="#FFFFFF" height="548.7031" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="279" x="33" y="142.2969"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="30" x2="315" y1="139.2969" y2="139.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="131" x="107" y="129.9951">updateComponent</text><!--cluster setState--><rect fill="#FEFECE" filter="url(#f1masgnn5sk3fv)" height="203" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="238" x="477" y="515"/><rect fill="#FFFFFF" height="170.7031" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="232" x="480" y="544.2969"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="477" x2="715" y1="541.2969" y2="541.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="567" y="531.9951">setState</text><!--cluster enqueueSetState--><rect fill="#FEFECE" filter="url(#f1masgnn5sk3fv)" height="120" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="166" x="517" y="566"/><rect fill="#FFFFFF" height="68.7344" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="160" x="520" y="614.2656"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="517" x2="683" y1="611.2656" y2="611.2656"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="517" x2="683" y1="592.2969" y2="592.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="539" y="582.9951">enqueueSetState</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="120" x="522" y="605.9355">初始化并压入更新队列</text><rect fill="#FEFECE" filter="url(#f1masgnn5sk3fv)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="172" x="102" y="394"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="102" x2="274" y1="420.2969" y2="420.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="112" y="411.9951">componentWillUpdate</text><rect fill="#FEFECE" filter="url(#f1masgnn5sk3fv)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="199" x="88.5" y="267"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="88.5" x2="287.5" y1="293.2969" y2="293.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="179" x="98.5" y="284.9951">shouldComponentUpdate</text><rect fill="#FEFECE" filter="url(#f1masgnn5sk3fv)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="217" x="73.5" y="156"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="73.5" x2="290.5" y1="182.2969" y2="182.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="197" x="83.5" y="173.9951">componentWillReceiveProps</text><rect fill="#FEFECE" filter="url(#f1masgnn5sk3fv)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="73.5" y="620"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="73.5" x2="246.5" y1="646.2969" y2="646.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="153" x="83.5" y="637.9951">componentDidUpdate</text><rect fill="#FEFECE" filter="url(#f1masgnn5sk3fv)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="533.5" y="620"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="533.5" x2="666.5" y1="646.2969" y2="646.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="543.5" y="637.9951">enqueueUpdate</text><rect fill="#FEFECE" filter="url(#f1masgnn5sk3fv)" height="50.2656" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="244" x="321" y="8"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="321" x2="565" y1="34.2969" y2="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="183" x="351.5" y="25.9951">performUpdateIfNecessary</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="224" x="326" y="50.4355">更新队列 _pendingStateQueue 不为空</text><!--link cwrp to scu--><path d="M183.332,206.191 C184.233,222.56 185.428,244.279 186.384,261.64 " fill="none" id="cwrp-scu" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="186.672,266.877,190.1697,257.6701,186.3963,261.8846,182.1818,258.1112,186.672,266.877" style="stroke: #A80036; stroke-width: 1.0;"/><!--link scu to cwu--><path d="M188,317.101 C188,337.593 188,367.076 188,388.884 " fill="none" id="scu-cwu" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="188,393.973,192,384.973,188,388.973,184,384.973,188,393.973" style="stroke: #A80036; stroke-width: 1.0;"/><!--link cwu to cdu--><path d="M184.95,444.398 C179.75,485.997 169.193,570.46 163.625,615.003 " fill="none" id="cwu-cdu" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="163.004,619.971,168.0891,611.5365,163.624,615.0096,160.1509,610.5445,163.004,619.971" style="stroke: #A80036; stroke-width: 1.0;"/><!--link cwrp to setState--><path d="M224.372,206.042 C249.476,221.504 280.969,243.126 305,267 C370.346,331.919 415.1563,425.2093 443.7238,502.744 C458.0075,541.5114 468.2306,576.3399 474.9296,601.7137 C475.3483,603.2996 475.7532,604.8485 476.1445,606.3591 C476.3401,607.1145 476.5323,607.8602 476.7212,608.5962 " fill="none" id="cwrp-setState" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="476.7212,608.5962,478.359,598.8845,475.4786,603.7531,470.61,600.8727,476.7212,608.5962" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="379" y="360.0669">合并 state</text><!--link cwu to setState--><path d="M213.227,444.034 C230.544,459.381 254.708,478.647 279,491 C290.537,496.866 295.526,493.013 307,499 C351.5245,522.233 395.3405,557.722 428.3594,587.7744 C444.8688,602.8005 458.679,616.4676 468.5288,626.5638 C470.9912,629.0879 473.2061,631.3888 475.1538,633.432 C475.6408,633.9428 476.111,634.4375 476.5642,634.9155 C476.6775,635.035 476.7897,635.1535 476.9009,635.2709 " fill="none" id="cwu-setState" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="476.9009,635.2709,473.6178,625.9854,473.4633,631.6401,467.8086,631.4856,476.9009,635.2709" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="280" y="487.0669">无限循环</text><!--link scu to setState--><path d="M214.801,317.386 C236.188,337.285 266.516,366.506 291,394 C337.0365,445.6945 384.752,507.0643 421.3415,556.0623 C439.6363,580.5613 455.1495,601.9675 466.2806,617.5248 C469.0634,621.4141 471.5723,624.9379 473.7823,628.0531 C474.8873,629.6106 475.9176,631.0661 476.87,632.414 " fill="none" id="scu-setState" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="476.87,632.414,474.9431,622.7555,473.9846,628.3305,468.4096,627.3721,476.87,632.414" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="333" y="423.5669">无限循环</text><!--link cdu to setState--><path d="M246.667,645 C293.301,645 350.6758,645 397.445,645 C420.8296,645 441.5629,645 456.9765,645 C464.6833,645 471.0601,645 475.7736,645 C476.0682,645 476.3563,645 476.6378,645 " fill="none" id="cdu-setState" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="476.6378,645,467.6378,641,471.6378,645,467.6378,649,476.6378,645" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="264.57" y="638.0669">更新队列为空，触发二次 setState</text><!--link enqueueUpdate to puin--><path d="M598.57,619.813 C596.269,578.75 592,492.769 592,420 C592,180 592,180 592,180 C592,125.838 541.151,85.132 498.863,60.644 " fill="none" id="enqueueUpdate-puin" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="494.277,58.032,500.1179,65.962,498.6217,60.5065,504.0771,59.0104,494.277,58.032" style="stroke: #A80036; stroke-width: 1.0;"/><!--link puin to updateComponent--><path d="M320.812,39.36 C222.38,46.249 94.4398,61.856 57,97 C53.6588,100.1363 50.8482,103.73 48.4887,107.6245 C47.8988,108.5982 47.3371,109.5906 46.8023,110.5994 C46.535,111.1038 46.2743,111.6122 46.0203,112.1245 C45.8933,112.3806 45.7679,112.6377 45.6441,112.8956 " fill="none" id="puin-updateComponent" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="45.6441,112.8956,53.1433,106.5111,47.8067,108.3875,45.9303,103.0509,45.6441,112.8956" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
state updateComponent {
  state "componentWillUpdate" as cwu
  state "shouldComponentUpdate" as scu 
  state "componentWillReceiveProps" as cwrp
  state "componentDidUpdate" as  cdu
  cwrp - -> scu
  scu - -> cwu
  cwu - -> cdu
  cwrp - -> setState : 合并 state
  cwu - -> setState : 无限循环
  scu - -> setState : 无限循环
  cdu - -> setState : 更新队列为空，触发二次 setState
}

state setState {
  state enqueueSetState {
    enqueueSetState: 初始化并压入更新队列

    state enqueueUpdate
    enqueueUpdate - -> puin
  }   
}

state "performUpdateIfNecessary" as puin {
  puin: 更新队列 _pendingStateQueue 不为空
}

puin - -> updateComponent
@enduml

PlantUML version 1.2019.04(Fri Mar 29 15:44:36 UTC 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_212-8u212-b01-1~deb9u1-b01
Operating System: Linux
OS Version: 3.10.0-957.1.3.el7.x86_64
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>